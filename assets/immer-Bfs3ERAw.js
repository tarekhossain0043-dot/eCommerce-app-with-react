var fe=Symbol.for("immer-nothing"),j=Symbol.for("immer-draftable"),f=Symbol.for("immer-state");function u(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var a=Object,m=a.getPrototypeOf,k="constructor",E="prototype",b="configurable",A="enumerable",F="writable",S="value",y=e=>!!e&&!!e[f];function d(e){return e?ae(e)||N(e)||!!e[j]||!!e[k]?.[j]||U(e)||x(e):!1}var Pe=a[E][k].toString(),ee=new WeakMap;function ae(e){if(!e||!J(e))return!1;const t=m(e);if(t===null||t===a[E])return!0;const r=a.hasOwnProperty.call(t,k)&&t[k];if(r===Object)return!0;if(!P(r))return!1;let n=ee.get(r);return n===void 0&&(n=Function.toString.call(r),ee.set(r,n)),n===Pe}function T(e,t,r=!0){v(e)===0?(r?Reflect.ownKeys(e):a.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((n,i)=>t(i,n,e))}function v(e){const t=e[f];return t?t.type_:N(e)?1:U(e)?2:x(e)?3:0}var te=(e,t,r=v(e))=>r===2?e.has(t):a[E].hasOwnProperty.call(e,t),K=(e,t,r=v(e))=>r===2?e.get(t):e[t],I=(e,t,r,n=v(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function me(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var N=Array.isArray,U=e=>e instanceof Map,x=e=>e instanceof Set,J=e=>typeof e=="object",P=e=>typeof e=="function",B=e=>typeof e=="boolean";function Se(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var _=e=>e.copy_||e.base_,Q=e=>e.modified_?e.copy_:e.base_;function G(e,t){if(U(e))return new Map(e);if(x(e))return new Set(e);if(N(e))return Array[E].slice.call(e);const r=ae(e);if(t===!0||t==="class_only"&&!r){const n=a.getOwnPropertyDescriptors(e);delete n[f];let i=Reflect.ownKeys(n);for(let o=0;o<i.length;o++){const s=i[o],c=n[s];c[F]===!1&&(c[F]=!0,c[b]=!0),(c.get||c.set)&&(n[s]={[b]:!0,[F]:!0,[A]:c[A],[S]:e[s]})}return a.create(m(e),n)}else{const n=m(e);if(n!==null&&r)return{...e};const i=a.create(n);return a.assign(i,e)}}function Z(e,t=!1){return L(e)||y(e)||!d(e)||(v(e)>1&&a.defineProperties(e,{set:C,add:C,clear:C,delete:C}),a.freeze(e),t&&T(e,(r,n)=>{Z(n,!0)},!1)),e}function ge(){u(2)}var C={[S]:ge};function L(e){return e===null||!J(e)?!0:a.isFrozen(e)}var O="MapSet",Y="Patches",re="ArrayMethods",ue={};function p(e){const t=ue[e];return t||u(0,e),t}var ne=e=>!!ue[e],g,le=()=>g,ze=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:ne(O)?p(O):void 0,arrayMethodsPlugin_:ne(re)?p(re):void 0});function ie(e,t){t&&(e.patchPlugin_=p(Y),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function H(e){X(e),e.drafts_.forEach(ve),e.drafts_=null}function X(e){e===g&&(g=e.parent_)}var oe=e=>g=ze(g,e);function ve(e){const t=e[f];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function se(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[f].modified_&&(H(t),u(4)),d(e)&&(e=ce(t,e));const{patchPlugin_:i}=t;i&&i.generateReplacementPatches_(r[f].base_,e,t)}else e=ce(t,r);return we(t,e,!0),H(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==fe?e:void 0}function ce(e,t){if(L(t))return t;const r=t[f];if(!r)return D(t,e.handledSet_,e);if(!V(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);he(r,e)}return r.copy_}function we(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Z(t,r)}function _e(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var V=(e,t)=>e.scope_===t,Ce=[];function de(e,t,r,n){const i=_(e),o=e.type_;if(n!==void 0&&K(i,n,o)===t){I(i,n,r,o);return}if(!e.draftLocations_){const c=e.draftLocations_=new Map;T(i,(l,h)=>{if(y(h)){const w=c.get(h)||[];w.push(l),c.set(h,w)}})}const s=e.draftLocations_.get(t)??Ce;for(const c of s)I(i,c,r,o)}function Fe(e,t,r){e.callbacks_.push(function(i){const o=t;if(!o||!V(o,i))return;i.mapSetPlugin_?.fixSetContents(o);const s=Q(o);de(e,o.draft_??o,s,r),he(o,i)})}function he(e,t){if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(e.assigned_?.size??0)>0)){const{patchPlugin_:n}=t;if(n){const i=n.getPath(e);i&&n.generatePatches_(e,i,t)}_e(e)}}function Me(e,t,r){const{scope_:n}=e;if(y(r)){const i=r[f];V(i,n)&&i.callbacks_.push(function(){M(e);const s=Q(i);de(e,r,s,t)})}else d(r)&&e.callbacks_.push(function(){const o=_(e);e.type_===3?o.has(r)&&D(r,n.handledSet_,n):K(o,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&D(K(e.copy_,t,e.type_),n.handledSet_,n)})}function D(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||y(e)||t.has(e)||!d(e)||L(e)||(t.add(e),T(e,(n,i)=>{if(y(i)){const o=i[f];if(V(o,r)){const s=Q(o);I(e,n,s,e.type_),_e(o)}}else d(i)&&D(i,t,r)})),e}function ke(e,t){const r=N(e),n={type_:r?1:0,scope_:t?t.scope_:le(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let i=n,o=R;r&&(i=[n],o=z);const{revoke:s,proxy:c}=Proxy.revocable(i,o);return n.draft_=c,n.revoke_=s,[c,n]}var R={get(e,t){if(t===f)return e;let r=e.scope_.arrayMethodsPlugin_;const n=e.type_===1&&typeof t=="string";if(n&&r?.isArrayOperationMethod(t))return r.createMethodInterceptor(e,t);const i=_(e);if(!te(i,t,e.type_))return Ae(e,i,t);const o=i[t];if(e.finalized_||!d(o)||n&&e.operationMethod&&r?.isMutatingArrayMethod(e.operationMethod)&&Se(t))return o;if(o===W(e.base_,t)){M(e);const s=e.type_===1?+t:t,c=q(e.scope_,o,e,s);return e.copy_[s]=c}return o},has(e,t){return t in _(e)},ownKeys(e){return Reflect.ownKeys(_(e))},set(e,t,r){const n=ye(_(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=W(_(e),t),o=i?.[f];if(o&&o.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(me(r,i)&&(r!==void 0||te(e.base_,t,e.type_)))return!0;M(e),$(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),Me(e,t,r)),!0},deleteProperty(e,t){return M(e),W(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),$(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=_(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[F]:!0,[b]:e.type_!==1||t!=="length",[A]:n[A],[S]:r[t]}},defineProperty(){u(11)},getPrototypeOf(e){return m(e.base_)},setPrototypeOf(){u(12)}},z={};for(let e in R){let t=R[e];z[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}}z.deleteProperty=function(e,t){return z.set.call(this,e,t,void 0)};z.set=function(e,t,r){return R.set.call(this,e[0],t,r,e[0])};function W(e,t){const r=e[f];return(r?_(r):e)[t]}function Ae(e,t,r){const n=ye(t,r);return n?S in n?n[S]:n.get?.call(e.draft_):void 0}function ye(e,t){if(!(t in e))return;let r=m(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=m(r)}}function $(e){e.modified_||(e.modified_=!0,e.parent_&&$(e.parent_))}function M(e){e.copy_||(e.assigned_=new Map,e.copy_=G(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Ie=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(t,r,n)=>{if(P(t)&&!P(r)){const o=r;r=t;const s=this;return function(l=o,...h){return s.produce(l,w=>r.call(this,w,...h))}}P(r)||u(6),n!==void 0&&!P(n)&&u(7);let i;if(d(t)){const o=oe(this),s=q(o,t,void 0);let c=!0;try{i=r(s),c=!1}finally{c?H(o):X(o)}return ie(o,n),se(i,o)}else if(!t||!J(t)){if(i=r(t),i===void 0&&(i=t),i===fe&&(i=void 0),this.autoFreeze_&&Z(i,!0),n){const o=[],s=[];p(Y).generateReplacementPatches_(t,i,{patches_:o,inversePatches_:s}),n(o,s)}return i}else u(1,t)},this.produceWithPatches=(t,r)=>{if(P(t))return(s,...c)=>this.produceWithPatches(s,l=>t(l,...c));let n,i;return[this.produce(t,r,(s,c)=>{n=s,i=c}),n,i]},B(e?.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),B(e?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),B(e?.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){d(e)||u(8),y(e)&&(e=Oe(e));const t=oe(this),r=q(t,e,void 0);return r[f].isManual_=!0,X(t),r}finishDraft(e,t){const r=e&&e[f];(!r||!r.isManual_)&&u(9);const{scope_:n}=r;return ie(n,t),se(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=p(Y).applyPatches_;return y(e)?n(e,t):this.produce(e,i=>n(i,t))}};function q(e,t,r,n){const[i,o]=U(t)?p(O).proxyMap_(t,r):x(t)?p(O).proxySet_(t,r):ke(t,r);return(r?.scope_??le()).drafts_.push(i),o.callbacks_=r?.callbacks_??[],o.key_=n,r&&n!==void 0?Fe(r,o,n):o.callbacks_.push(function(l){l.mapSetPlugin_?.fixSetContents(o);const{patchPlugin_:h}=l;o.modified_&&h&&h.generatePatches_(o,[],l)}),i}function Oe(e){return y(e)||u(10,e),pe(e)}function pe(e){if(!d(e)||L(e))return e;const t=e[f];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=G(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=G(e,!0);return T(r,(i,o)=>{I(r,i,pe(o))},n),t&&(t.finalized_=!1),r}var De=new Ie,Re=De.produce;export{y as a,Oe as c,d as i,Re as p};
