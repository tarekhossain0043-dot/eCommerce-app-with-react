var ye=Symbol.for("immer-nothing"),V=Symbol.for("immer-draftable"),P=Symbol.for("immer-state");function g(e,...r){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var v=Object,R=v.getPrototypeOf,W="constructor",Y="prototype",ue="configurable",j="enumerable",Q="writable",B="value",A=e=>!!e&&!!e[P];function C(e){return e?Fe(e)||H(e)||!!e[V]||!!e[W]?.[V]||X(e)||q(e):!1}var Ne=v[Y][W].toString(),Se=new WeakMap;function Fe(e){if(!e||!U(e))return!1;const r=R(e);if(r===null||r===v[Y])return!0;const t=v.hasOwnProperty.call(r,W)&&r[W];if(t===Object)return!0;if(!I(t))return!1;let n=Se.get(t);return n===void 0&&(n=Function.toString.call(t),Se.set(t,n)),n===Ne}function Qe(e){return A(e)||g(15,e),e[P].base_}function $(e,r,t=!0){D(e)===0?(t?Reflect.ownKeys(e):v.keys(e)).forEach(i=>{r(i,e[i],e)}):e.forEach((n,i)=>r(i,n,e))}function D(e){const r=e[P];return r?r.type_:H(e)?1:X(e)?2:q(e)?3:0}var L=(e,r,t=D(e))=>t===2?e.has(r):v[Y].hasOwnProperty.call(e,r),k=(e,r,t=D(e))=>t===2?e.get(r):e[r],ee=(e,r,t,n=D(e))=>{n===2?e.set(r,t):n===3?e.add(t):e[r]=t};function xe(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}var H=Array.isArray,X=e=>e instanceof Map,q=e=>e instanceof Set,U=e=>typeof e=="object",I=e=>typeof e=="function",fe=e=>typeof e=="boolean";function Ue(e){const r=+e;return Number.isInteger(r)&&String(r)===e}var Ve=e=>U(e)?e?.[P]:null,F=e=>e.copy_||e.base_,Pe=e=>e.modified_?e.copy_:e.base_;function le(e,r){if(X(e))return new Map(e);if(q(e))return new Set(e);if(H(e))return Array[Y].slice.call(e);const t=Fe(e);if(r===!0||r==="class_only"&&!t){const n=v.getOwnPropertyDescriptors(e);delete n[P];let i=Reflect.ownKeys(n);for(let o=0;o<i.length;o++){const u=i[o],d=n[u];d[Q]===!1&&(d[Q]=!0,d[ue]=!0),(d.get||d.set)&&(n[u]={[ue]:!0,[Q]:!0,[j]:d[j],[B]:e[u]})}return v.create(R(e),n)}else{const n=R(e);if(n!==null&&t)return{...e};const i=v.create(n);return v.assign(i,e)}}function ge(e,r=!1){return ce(e)||A(e)||!C(e)||(D(e)>1&&v.defineProperties(e,{set:J,add:J,clear:J,delete:J}),v.freeze(e),r&&$(e,(t,n)=>{ge(n,!0)},!1)),e}function Le(){g(2)}var J={[B]:Le};function ce(e){return e===null||!U(e)?!0:v.isFrozen(e)}var re="MapSet",te="Patches",ve="ArrayMethods",ne={};function E(e){const r=ne[e];return r||g(0,e),r}var we=e=>!!ne[e];function We(e,r){ne[e]||(ne[e]=r)}var K,Oe=()=>K,Be=(e,r)=>({drafts_:[],parent_:e,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:we(re)?E(re):void 0,arrayMethodsPlugin_:we(ve)?E(ve):void 0});function ze(e,r){r&&(e.patchPlugin_=E(te),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function _e(e){de(e),e.drafts_.forEach(Ke),e.drafts_=null}function de(e){e===K&&(K=e.parent_)}var Ae=e=>K=Be(K,e);function Ke(e){const r=e[P];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function Ce(e,r){r.unfinalizedDrafts_=r.drafts_.length;const t=r.drafts_[0];if(e!==void 0&&e!==t){t[P].modified_&&(_e(r),g(4)),C(e)&&(e=ke(r,e));const{patchPlugin_:i}=r;i&&i.generateReplacementPatches_(t[P].base_,e,r)}else e=ke(r,t);return be(r,e,!0),_e(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==ye?e:void 0}function ke(e,r){if(ce(r))return r;const t=r[P];if(!t)return ie(r,e.handledSet_,e);if(!se(t,e))return r;if(!t.modified_)return t.base_;if(!t.finalized_){const{callbacks_:n}=t;if(n)for(;n.length>0;)n.pop()(e);Re(t,e)}return t.copy_}function be(e,r,t=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&ge(r,t)}function Me(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var se=(e,r)=>e.scope_===r,Ge=[];function Ie(e,r,t,n){const i=F(e),o=e.type_;if(n!==void 0&&k(i,n,o)===r){ee(i,n,t,o);return}if(!e.draftLocations_){const d=e.draftLocations_=new Map;$(i,(w,z)=>{if(A(z)){const T=d.get(z)||[];T.push(w),d.set(z,T)}})}const u=e.draftLocations_.get(r)??Ge;for(const d of u)ee(i,d,t,o)}function Ye(e,r,t){e.callbacks_.push(function(i){const o=r;if(!o||!se(o,i))return;i.mapSetPlugin_?.fixSetContents(o);const u=Pe(o);Ie(e,o.draft_??o,u,t),Re(o,i)})}function Re(e,r){if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(e.assigned_?.size??0)>0)){const{patchPlugin_:n}=r;if(n){const i=n.getPath(e);i&&n.generatePatches_(e,i,r)}Me(e)}}function $e(e,r,t){const{scope_:n}=e;if(A(t)){const i=t[P];se(i,n)&&i.callbacks_.push(function(){Z(e);const u=Pe(i);Ie(e,t,u,r)})}else C(t)&&e.callbacks_.push(function(){const o=F(e);e.type_===3?o.has(t)&&ie(t,n.handledSet_,n):k(o,r,e.type_)===t&&n.drafts_.length>1&&(e.assigned_.get(r)??!1)===!0&&e.copy_&&ie(k(e.copy_,r,e.type_),n.handledSet_,n)})}function ie(e,r,t){return!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||A(e)||r.has(e)||!C(e)||ce(e)||(r.add(e),$(e,(n,i)=>{if(A(i)){const o=i[P];if(se(o,t)){const u=Pe(o);ee(e,n,u,e.type_),Me(o)}}else C(i)&&ie(i,r,t)})),e}function He(e,r){const t=H(e),n={type_:t?1:0,scope_:r?r.scope_:Oe(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let i=n,o=oe;t&&(i=[n],o=b);const{revoke:u,proxy:d}=Proxy.revocable(i,o);return n.draft_=d,n.revoke_=u,[d,n]}var oe={get(e,r){if(r===P)return e;let t=e.scope_.arrayMethodsPlugin_;const n=e.type_===1&&typeof r=="string";if(n&&t?.isArrayOperationMethod(r))return t.createMethodInterceptor(e,r);const i=F(e);if(!L(i,r,e.type_))return Xe(e,i,r);const o=i[r];if(e.finalized_||!C(o)||n&&e.operationMethod&&t?.isMutatingArrayMethod(e.operationMethod)&&Ue(r))return o;if(o===ae(e.base_,r)){Z(e);const u=e.type_===1?+r:r,d=pe(e.scope_,o,e,u);return e.copy_[u]=d}return o},has(e,r){return r in F(e)},ownKeys(e){return Reflect.ownKeys(F(e))},set(e,r,t){const n=De(F(e),r);if(n?.set)return n.set.call(e.draft_,t),!0;if(!e.modified_){const i=ae(F(e),r),o=i?.[P];if(o&&o.base_===t)return e.copy_[r]=t,e.assigned_.set(r,!1),!0;if(xe(t,i)&&(t!==void 0||L(e.base_,r,e.type_)))return!0;Z(e),he(e)}return e.copy_[r]===t&&(t!==void 0||r in e.copy_)||Number.isNaN(t)&&Number.isNaN(e.copy_[r])||(e.copy_[r]=t,e.assigned_.set(r,!0),$e(e,r,t)),!0},deleteProperty(e,r){return Z(e),ae(e.base_,r)!==void 0||r in e.base_?(e.assigned_.set(r,!1),he(e)):e.assigned_.delete(r),e.copy_&&delete e.copy_[r],!0},getOwnPropertyDescriptor(e,r){const t=F(e),n=Reflect.getOwnPropertyDescriptor(t,r);return n&&{[Q]:!0,[ue]:e.type_!==1||r!=="length",[j]:n[j],[B]:t[r]}},defineProperty(){g(11)},getPrototypeOf(e){return R(e.base_)},setPrototypeOf(){g(12)}},b={};for(let e in oe){let r=oe[e];b[e]=function(){const t=arguments;return t[0]=t[0][0],r.apply(this,t)}}b.deleteProperty=function(e,r){return b.set.call(this,e,r,void 0)};b.set=function(e,r,t){return oe.set.call(this,e[0],r,t,e[0])};function ae(e,r){const t=e[P];return(t?F(t):e)[r]}function Xe(e,r,t){const n=De(r,t);return n?B in n?n[B]:n.get?.call(e.draft_):void 0}function De(e,r){if(!(r in e))return;let t=R(e);for(;t;){const n=Object.getOwnPropertyDescriptor(t,r);if(n)return n;t=R(t)}}function he(e){e.modified_||(e.modified_=!0,e.parent_&&he(e.parent_))}function Z(e){e.copy_||(e.assigned_=new Map,e.copy_=le(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var qe=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,t,n)=>{if(I(r)&&!I(t)){const o=t;t=r;const u=this;return function(w=o,...z){return u.produce(w,T=>t.call(this,T,...z))}}I(t)||g(6),n!==void 0&&!I(n)&&g(7);let i;if(C(r)){const o=Ae(this),u=pe(o,r,void 0);let d=!0;try{i=t(u),d=!1}finally{d?_e(o):de(o)}return ze(o,n),Ce(i,o)}else if(!r||!U(r)){if(i=t(r),i===void 0&&(i=r),i===ye&&(i=void 0),this.autoFreeze_&&ge(i,!0),n){const o=[],u=[];E(te).generateReplacementPatches_(r,i,{patches_:o,inversePatches_:u}),n(o,u)}return i}else g(1,r)},this.produceWithPatches=(r,t)=>{if(I(r))return(u,...d)=>this.produceWithPatches(u,w=>r(w,...d));let n,i;return[this.produce(r,t,(u,d)=>{n=u,i=d}),n,i]},fe(e?.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),fe(e?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),fe(e?.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){C(e)||g(8),A(e)&&(e=Je(e));const r=Ae(this),t=pe(r,e,void 0);return t[P].isManual_=!0,de(r),t}finishDraft(e,r){const t=e&&e[P];(!t||!t.isManual_)&&g(9);const{scope_:n}=t;return ze(n,r),Ce(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let t;for(t=r.length-1;t>=0;t--){const i=r[t];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}t>-1&&(r=r.slice(t+1));const n=E(te).applyPatches_;return A(e)?n(e,r):this.produce(e,i=>n(i,r))}};function pe(e,r,t,n){const[i,o]=X(r)?E(re).proxyMap_(r,t):q(r)?E(re).proxySet_(r,t):He(r,t);return(t?.scope_??Oe()).drafts_.push(i),o.callbacks_=t?.callbacks_??[],o.key_=n,t&&n!==void 0?Ye(t,o,n):o.callbacks_.push(function(w){w.mapSetPlugin_?.fixSetContents(o);const{patchPlugin_:z}=w;o.modified_&&z&&z.generatePatches_(o,[],w)}),i}function Je(e){return A(e)||g(10,e),Ee(e)}function Ee(e){if(!C(e)||ce(e))return e;const r=e[P];let t,n=!0;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,t=le(e,r.scope_.immer_.useStrictShallowCopy_),n=r.scope_.immer_.shouldUseStrictIteration()}else t=le(e,!0);return $(t,(i,o)=>{ee(t,i,Ee(o))},n),r&&(r.finalized_=!1),t}function Ze(){function r(c,a=[]){if(c.key_!==void 0){const s=c.parent_.copy_??c.parent_.base_,l=Ve(k(s,c.key_)),_=k(s,c.key_);if(_===void 0||_!==c.draft_&&_!==c.base_&&_!==c.copy_||l!=null&&l.base_!==c.base_)return null;const h=c.parent_.type_===3;let p;if(h){const y=c.parent_;p=Array.from(y.drafts_.keys()).indexOf(c.key_)}else p=c.key_;if(!(h&&s.size>p||L(s,p)))return null;a.push(p)}if(c.parent_)return r(c.parent_,a);a.reverse();try{t(c.copy_,a)}catch{return null}return a}function t(c,a){let s=c;for(let l=0;l<a.length-1;l++){const _=a[l];if(s=k(s,_),!U(s)||s===null)throw new Error(`Cannot resolve path at '${a.join("/")}'`)}return s}const n="replace",i="add",o="remove";function u(c,a,s){if(c.scope_.processedForPatches_.has(c))return;c.scope_.processedForPatches_.add(c);const{patches_:l,inversePatches_:_}=s;switch(c.type_){case 0:case 2:return w(c,a,l,_);case 1:return d(c,a,l,_);case 3:return z(c,a,l,_)}}function d(c,a,s,l){let{base_:_,assigned_:h}=c,p=c.copy_;p.length<_.length&&([_,p]=[p,_],[s,l]=[l,s]);const y=c.allIndicesReassigned_===!0;for(let f=0;f<_.length;f++){const S=p[f],O=_[f];if((y||h?.get(f.toString()))&&S!==O){const M=S?.[P];if(M&&M.modified_)continue;const me=a.concat([f]);s.push({op:n,path:me,value:x(S)}),l.push({op:n,path:me,value:x(O)})}}for(let f=_.length;f<p.length;f++){const S=a.concat([f]);s.push({op:i,path:S,value:x(p[f])})}for(let f=p.length-1;_.length<=f;--f){const S=a.concat([f]);l.push({op:o,path:S})}}function w(c,a,s,l){const{base_:_,copy_:h,type_:p}=c;$(c.assigned_,(y,f)=>{const S=k(_,y,p),O=k(h,y,p),m=f?L(_,y)?n:i:o;if(S===O&&m===n)return;const M=a.concat(y);s.push(m===o?{op:m,path:M}:{op:m,path:M,value:x(O)}),l.push(m===i?{op:o,path:M}:m===o?{op:i,path:M,value:x(S)}:{op:n,path:M,value:x(S)})})}function z(c,a,s,l){let{base_:_,copy_:h}=c,p=0;_.forEach(y=>{if(!h.has(y)){const f=a.concat([p]);s.push({op:o,path:f,value:y}),l.unshift({op:i,path:f,value:y})}p++}),p=0,h.forEach(y=>{if(!_.has(y)){const f=a.concat([p]);s.push({op:i,path:f,value:y}),l.unshift({op:o,path:f,value:y})}p++})}function T(c,a,s){const{patches_:l,inversePatches_:_}=s;l.push({op:n,path:[],value:a===ye?void 0:a}),_.push({op:n,path:[],value:c})}function Te(c,a){return a.forEach(s=>{const{path:l,op:_}=s;let h=c;for(let S=0;S<l.length-1;S++){const O=D(h);let m=l[S];typeof m!="string"&&typeof m!="number"&&(m=""+m),(O===0||O===1)&&(m==="__proto__"||m===W)&&g(19),I(h)&&m===Y&&g(19),h=k(h,m),U(h)||g(18,l.join("/"))}const p=D(h),y=N(s.value),f=l[l.length-1];switch(_){case n:switch(p){case 2:return h.set(f,y);case 3:g(16);default:return h[f]=y}case i:switch(p){case 1:return f==="-"?h.push(y):h.splice(f,0,y);case 2:return h.set(f,y);case 3:return h.add(y);default:return h[f]=y}case o:switch(p){case 1:return h.splice(f,1);case 2:return h.delete(f);case 3:return h.delete(s.value);default:return delete h[f]}default:g(17,_)}}),c}function N(c){if(!C(c))return c;if(H(c))return c.map(N);if(X(c))return new Map(Array.from(c.entries()).map(([s,l])=>[s,N(l)]));if(q(c))return new Set(Array.from(c).map(N));const a=Object.create(R(c));for(const s in c)a[s]=N(c[s]);return L(c,V)&&(a[V]=c[V]),a}function x(c){return A(c)?N(c):c}We(te,{applyPatches_:Te,generatePatches_:u,generateReplacementPatches_:T,getPath:r})}var G=new qe,je=G.produce,er=G.produceWithPatches.bind(G),rr=G.applyPatches.bind(G);export{A as a,rr as b,er as c,Je as d,Ze as e,C as i,Qe as o,je as p};
